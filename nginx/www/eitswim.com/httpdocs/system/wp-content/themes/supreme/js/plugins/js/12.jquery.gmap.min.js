!function(a){a.fn.gMap=function(c,b){switch(c){case"addMarker":return a(this).trigger("gMap.addMarker",[b.latitude,b.longitude,b.content,b.icon,b.popup]);case"centerAt":return a(this).trigger("gMap.centerAt",[b.latitude,b.longitude,b.zoom]);case"clearMarkers":return a(this).trigger("gMap.clearMarkers")}var d=a.extend({},a.fn.gMap.defaults,c);return this.each(function(){var h=new google.maps.Map(this);a(this).data("gMap.reference",h);var w=new google.maps.Geocoder;d.address?w.geocode({address:d.address},function(g){g&&g.length&&h.setCenter(g[0].geometry.location)}):d.latitude&&d.longitude?h.setCenter(new google.maps.LatLng(d.latitude,d.longitude)):a.isArray(d.markers)&&d.markers.length>0?d.markers[0].address?w.geocode({address:d.markers[0].address},function(g){g&&g.length>0&&h.setCenter(g[0].geometry.location)}):h.setCenter(new google.maps.LatLng(d.markers[0].latitude,d.markers[0].longitude)):h.setCenter(new google.maps.LatLng(34.885931,9.84375)),h.setZoom(d.zoom),h.setMapTypeId(google.maps.MapTypeId[d.maptype]);var y={scrollwheel:d.scrollwheel,disableDoubleClickZoom:!d.doubleclickzoom};d.controls===!1?a.extend(y,{disableDefaultUI:!0}):0!==d.controls.length&&a.extend(y,d.controls,{disableDefaultUI:!0}),h.setOptions(y),h.setOptions({styles:d.styles});var x,e,n=new google.maps.Marker;x=new google.maps.MarkerImage(d.icon.image),x.size=new google.maps.Size(d.icon.iconsize[0],d.icon.iconsize[1]),x.anchor=new google.maps.Point(d.icon.iconanchor[0],d.icon.iconanchor[1]),n.setIcon(x),d.icon.shadow&&(e=new google.maps.MarkerImage(d.icon.shadow),e.size=new google.maps.Size(d.icon.shadowsize[0],d.icon.shadowsize[1]),e.anchor=new google.maps.Point(d.icon.shadowanchor[0],d.icon.shadowanchor[1]),n.setShadow(e)),a(this).bind("gMap.centerAt",function(l,g,m,i){i&&h.setZoom(i),h.panTo(new google.maps.LatLng(parseFloat(g),parseFloat(m)))});var q=[];a(this).bind("gMap.clearMarkers",function(){for(;q[0];){q.pop().setMap(null)}});var k;a(this).bind("gMap.addMarker",function(z,C,F,E,g,A){var B,i,l=new google.maps.LatLng(parseFloat(C),parseFloat(F)),o=new google.maps.Marker({position:l});if(g?(B=new google.maps.MarkerImage(g.image),B.size=new google.maps.Size(g.iconsize[0],g.iconsize[1]),B.anchor=new google.maps.Point(g.iconanchor[0],g.iconanchor[1]),o.setIcon(B),g.shadow&&(i=new google.maps.MarkerImage(g.shadow),i.size=new google.maps.Size(g.shadowsize[0],g.shadowsize[1]),i.anchor=new google.maps.Point(g.shadowanchor[0],g.shadowanchor[1]),n.setShadow(i))):(o.setIcon(n.getIcon()),o.setShadow(n.getShadow())),E){"_latlng"===E&&(E=C+", "+F);var D=new google.maps.InfoWindow({content:d.html_prepend+E+d.html_append});google.maps.event.addListener(o,"click",function(){k&&k.close(),D.open(h,o),k=D}),A&&google.maps.event.addListenerOnce(h,"tilesloaded",function(){D.open(h,o)})}o.setMap(h),q.push(o)});for(var u,v=this,f=function(g){return function(i){i&&i.length>0&&a(v).trigger("gMap.addMarker",[i[0].geometry.location.lat(),i[0].geometry.location.lng(),g.html,g.icon,g.popup])}},j=0;j<d.markers.length;j++){u=d.markers[j],u.address?("_address"===u.html&&(u.html=u.address),w.geocode({address:u.address},f(u))):a(this).trigger("gMap.addMarker",[u.latitude,u.longitude,u.html,u.icon,u.popup])}})},a.fn.gMap.defaults={address:"",latitude:0,longitude:0,zoom:1,markers:[],controls:[],styles:[],scrollwheel:!1,doubleclickzoom:!0,maptype:"ROADMAP",html_prepend:'<div class="gmap_marker">',html_append:"</div>",icon:{image:"http://www.google.com/mapfiles/marker.png",shadow:"http://www.google.com/mapfiles/shadow50.png",iconsize:[20,34],shadowsize:[37,34],iconanchor:[9,34],shadowanchor:[6,34]}}}(jQuery);